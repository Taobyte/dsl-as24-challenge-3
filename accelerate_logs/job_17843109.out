[2024-12-09 10:19:48,284][root][INFO] - tuner: false
use_optuna: false
n_trials: 100
training: true
multi_gpu: accelerate
test: false
plot:
  metrics: false
  visualization: false
  n_examples: 10
  vis_freq: 5
snrs:
- 0.1
- 0.3
- 0.5
- 0.7
- 1.0
- 1.2
- 1.5
- 1.8
- 2.0
- 2.5
- 3.5
size_testset: 500
model:
  model_name: CleanUNet
  use_csv: true
  train_pytorch: true
  tune_stft: false
  use_metrics: false
  use_baseline: false
  load_dummy: false
  save_model: true
  seed: 123
  snr_lower: 0.1
  snr_upper: 2.0
  event_shift_start: 5000
  random: true
  subset: null
  pure_noise: true
  batch_size: 384
  lr: 0.0002
  epochs: 5000
  clipnorm: 1000000000.0
  checkpoint_model: null
  patience: null
  log_checkpoints: true
  checkpoint_freq: 500
  lr_schedule: false
  decay_steps: 8000
  warmup_target: 0.0002
  alpha: 0.0
  warmup_steps: 80
  reduce_lr_plateau: true
  min_lr: 0.0001
  factor: 0.2
  plateau_patience: 3
  validation: false
  val_freq: 1000000000.0
  snrs: null
  loss: clean_unet_loss
  use_log_norm: false
  signal_length: 6120
  frame_lengths:
  - 100
  frame_steps:
  - 24
  fft_sizes:
  - 126
  stft_lambda: 1.0
  sc_lambda: 0.5
  mag_lambda: 0.5
  channels_input: 3
  channels_output: 3
  dropout: 0.0
  use_raglu: false
  channels_H: 64
  encoder_n_layers: 8
  kernel_size: 4
  stride: 2
  max_H: 768
  kernel_sizes:
  - 9
  - 9
  - 7
  - 7
  - 5
  - 5
  - 3
  - 3
  tsfm_n_layers: 5
  tsfm_n_head: 8
  tsfm_d_model: 1024
  tsfm_d_inner: 2048
  channel_base: 8
  channel_dims:
  - 1
  - 2
  - 4
  - 8
  bottleneck: lstm
user:
  data:
    signal_path: /cluster/scratch/ckeusch/data/signal/
    noise_path: /cluster/scratch/ckeusch/data/noise/
    csv_path: /cluster/scratch/ckeusch/dsl-as24-challenge-3/data/
  model_path: /cluster/scratch/ckeusch/dsl-as24-challenge-3/outputs/2024-12-08/10-04-03/1000/model.safetensors
  metrics_model_path: /cluster/scratch/ckeusch/dsl-as24-challenge-3/outputs/2024-12-06/11-02-09/metrics_model.csv
  metrics_butterworth_path: /cluster/scratch/ckeusch/dsl-as24-challenge-3/outputs/2024-12-03/10-59-47/metrics_butterworth.csv
  metrics_deepdenoiser_path: /cluster/scratch/ckeusch/dsl-as24-challenge-3/outputs/2024-11-08/DeepDenoiser
    Metrics/metrics_model.csv
  wandb: false

[2024-12-09 10:19:48,286][root][INFO] - tuner: false
use_optuna: false
n_trials: 100
training: true
multi_gpu: accelerate
test: false
plot:
  metrics: false
  visualization: false
  n_examples: 10
  vis_freq: 5
snrs:
- 0.1
- 0.3
- 0.5
- 0.7
- 1.0
- 1.2
- 1.5
- 1.8
- 2.0
- 2.5
- 3.5
size_testset: 500
model:
  model_name: CleanUNet
  use_csv: true
  train_pytorch: true
  tune_stft: false
  use_metrics: false
  use_baseline: false
  load_dummy: false
  save_model: true
  seed: 123
  snr_lower: 0.1
  snr_upper: 2.0
  event_shift_start: 5000
  random: true
  subset: null
  pure_noise: true
  batch_size: 384
  lr: 0.0002
  epochs: 5000
  clipnorm: 1000000000.0
  checkpoint_model: null
  patience: null
  log_checkpoints: true
  checkpoint_freq: 500
  lr_schedule: false
  decay_steps: 8000
  warmup_target: 0.0002
  alpha: 0.0
  warmup_steps: 80
  reduce_lr_plateau: true
  min_lr: 0.0001
  factor: 0.2
  plateau_patience: 3
  validation: false
  val_freq: 1000000000.0
  snrs: null
  loss: clean_unet_loss
  use_log_norm: false
  signal_length: 6120
  frame_lengths:
  - 100
  frame_steps:
  - 24
  fft_sizes:
  - 126
  stft_lambda: 1.0
  sc_lambda: 0.5
  mag_lambda: 0.5
  channels_input: 3
  channels_output: 3
  dropout: 0.0
  use_raglu: false
  channels_H: 64
  encoder_n_layers: 8
  kernel_size: 4
  stride: 2
  max_H: 768
  kernel_sizes:
  - 9
  - 9
  - 7
  - 7
  - 5
  - 5
  - 3
  - 3
  tsfm_n_layers: 5
  tsfm_n_head: 8
  tsfm_d_model: 1024
  tsfm_d_inner: 2048
  channel_base: 8
  channel_dims:
  - 1
  - 2
  - 4
  - 8
  bottleneck: lstm
user:
  data:
    signal_path: /cluster/scratch/ckeusch/data/signal/
    noise_path: /cluster/scratch/ckeusch/data/noise/
    csv_path: /cluster/scratch/ckeusch/dsl-as24-challenge-3/data/
  model_path: /cluster/scratch/ckeusch/dsl-as24-challenge-3/outputs/2024-12-08/10-04-03/1000/model.safetensors
  metrics_model_path: /cluster/scratch/ckeusch/dsl-as24-challenge-3/outputs/2024-12-06/11-02-09/metrics_model.csv
  metrics_butterworth_path: /cluster/scratch/ckeusch/dsl-as24-challenge-3/outputs/2024-12-03/10-59-47/metrics_butterworth.csv
  metrics_deepdenoiser_path: /cluster/scratch/ckeusch/dsl-as24-challenge-3/outputs/2024-11-08/DeepDenoiser
    Metrics/metrics_model.csv
  wandb: false

Im in main
Im in main
[2024-12-09 10:19:48,287][root][INFO] - tuner: false
use_optuna: false
n_trials: 100
training: true
multi_gpu: accelerate
test: false
plot:
  metrics: false
  visualization: false
  n_examples: 10
  vis_freq: 5
snrs:
- 0.1
- 0.3
- 0.5
- 0.7
- 1.0
- 1.2
- 1.5
- 1.8
- 2.0
- 2.5
- 3.5
size_testset: 500
model:
  model_name: CleanUNet
  use_csv: true
  train_pytorch: true
  tune_stft: false
  use_metrics: false
  use_baseline: false
  load_dummy: false
  save_model: true
  seed: 123
  snr_lower: 0.1
  snr_upper: 2.0
  event_shift_start: 5000
  random: true
  subset: null
  pure_noise: true
  batch_size: 384
  lr: 0.0002
  epochs: 5000
  clipnorm: 1000000000.0
  checkpoint_model: null
  patience: null
  log_checkpoints: true
  checkpoint_freq: 500
  lr_schedule: false
  decay_steps: 8000
  warmup_target: 0.0002
  alpha: 0.0
  warmup_steps: 80
  reduce_lr_plateau: true
  min_lr: 0.0001
  factor: 0.2
  plateau_patience: 3
  validation: false
  val_freq: 1000000000.0
  snrs: null
  loss: clean_unet_loss
  use_log_norm: false
  signal_length: 6120
  frame_lengths:
  - 100
  frame_steps:
  - 24
  fft_sizes:
  - 126
  stft_lambda: 1.0
  sc_lambda: 0.5
  mag_lambda: 0.5
  channels_input: 3
  channels_output: 3
  dropout: 0.0
  use_raglu: false
  channels_H: 64
  encoder_n_layers: 8
  kernel_size: 4
  stride: 2
  max_H: 768
  kernel_sizes:
  - 9
  - 9
  - 7
  - 7
  - 5
  - 5
  - 3
  - 3
  tsfm_n_layers: 5
  tsfm_n_head: 8
  tsfm_d_model: 1024
  tsfm_d_inner: 2048
  channel_base: 8
  channel_dims:
  - 1
  - 2
  - 4
  - 8
  bottleneck: lstm
user:
  data:
    signal_path: /cluster/scratch/ckeusch/data/signal/
    noise_path: /cluster/scratch/ckeusch/data/noise/
    csv_path: /cluster/scratch/ckeusch/dsl-as24-challenge-3/data/
  model_path: /cluster/scratch/ckeusch/dsl-as24-challenge-3/outputs/2024-12-08/10-04-03/1000/model.safetensors
  metrics_model_path: /cluster/scratch/ckeusch/dsl-as24-challenge-3/outputs/2024-12-06/11-02-09/metrics_model.csv
  metrics_butterworth_path: /cluster/scratch/ckeusch/dsl-as24-challenge-3/outputs/2024-12-03/10-59-47/metrics_butterworth.csv
  metrics_deepdenoiser_path: /cluster/scratch/ckeusch/dsl-as24-challenge-3/outputs/2024-11-08/DeepDenoiser
    Metrics/metrics_model.csv
  wandb: false

Im in main
[2024-12-09 10:19:48,288][root][INFO] - tuner: false
use_optuna: false
n_trials: 100
training: true
multi_gpu: accelerate
test: false
plot:
  metrics: false
  visualization: false
  n_examples: 10
  vis_freq: 5
snrs:
- 0.1
- 0.3
- 0.5
- 0.7
- 1.0
- 1.2
- 1.5
- 1.8
- 2.0
- 2.5
- 3.5
size_testset: 500
model:
  model_name: CleanUNet
  use_csv: true
  train_pytorch: true
  tune_stft: false
  use_metrics: false
  use_baseline: false
  load_dummy: false
  save_model: true
  seed: 123
  snr_lower: 0.1
  snr_upper: 2.0
  event_shift_start: 5000
  random: true
  subset: null
  pure_noise: true
  batch_size: 384
  lr: 0.0002
  epochs: 5000
  clipnorm: 1000000000.0
  checkpoint_model: null
  patience: null
  log_checkpoints: true
  checkpoint_freq: 500
  lr_schedule: false
  decay_steps: 8000
  warmup_target: 0.0002
  alpha: 0.0
  warmup_steps: 80
  reduce_lr_plateau: true
  min_lr: 0.0001
  factor: 0.2
  plateau_patience: 3
  validation: false
  val_freq: 1000000000.0
  snrs: null
  loss: clean_unet_loss
  use_log_norm: false
  signal_length: 6120
  frame_lengths:
  - 100
  frame_steps:
  - 24
  fft_sizes:
  - 126
  stft_lambda: 1.0
  sc_lambda: 0.5
  mag_lambda: 0.5
  channels_input: 3
  channels_output: 3
  dropout: 0.0
  use_raglu: false
  channels_H: 64
  encoder_n_layers: 8
  kernel_size: 4
  stride: 2
  max_H: 768
  kernel_sizes:
  - 9
  - 9
  - 7
  - 7
  - 5
  - 5
  - 3
  - 3
  tsfm_n_layers: 5
  tsfm_n_head: 8
  tsfm_d_model: 1024
  tsfm_d_inner: 2048
  channel_base: 8
  channel_dims:
  - 1
  - 2
  - 4
  - 8
  bottleneck: lstm
user:
  data:
    signal_path: /cluster/scratch/ckeusch/data/signal/
    noise_path: /cluster/scratch/ckeusch/data/noise/
    csv_path: /cluster/scratch/ckeusch/dsl-as24-challenge-3/data/
  model_path: /cluster/scratch/ckeusch/dsl-as24-challenge-3/outputs/2024-12-08/10-04-03/1000/model.safetensors
  metrics_model_path: /cluster/scratch/ckeusch/dsl-as24-challenge-3/outputs/2024-12-06/11-02-09/metrics_model.csv
  metrics_butterworth_path: /cluster/scratch/ckeusch/dsl-as24-challenge-3/outputs/2024-12-03/10-59-47/metrics_butterworth.csv
  metrics_deepdenoiser_path: /cluster/scratch/ckeusch/dsl-as24-challenge-3/outputs/2024-11-08/DeepDenoiser
    Metrics/metrics_model.csv
  wandb: false

Im in main
Im in fit_clean_unetIm in fit_clean_unet

start loading pickle filesstart loading pickle files
Im in fit_clean_unet

Im in fit_clean_unet
start loading pickle files
start loading pickle files
finished loading pickle files
finished loading pickle files
finished loading pickle files
finished loading pickle files
[2024-12-09 10:20:08,574][root][INFO] - CleanUNetPytorch Parameters: 73.088131M
 
[2024-12-09 10:20:08,582][root][INFO] - CleanUNetPytorch Parameters: 73.088131M
 
[2024-12-09 10:20:08,583][root][INFO] - CleanUNetPytorch Parameters: 73.088131M
 
[2024-12-09 10:20:08,590][root][INFO] - CleanUNetPytorch Parameters: 73.088131M
 
[2024-12-09 10:20:09,451][root][INFO] - Epoch 0
[2024-12-09 10:20:18,460][root][INFO] - train_loss: 108.14059972763062 | time: 9.009871244430542
[2024-12-09 10:20:18,462][root][INFO] - Epoch 1
[2024-12-09 10:20:27,196][root][INFO] - train_loss: 63.04987335205078 | time: 8.734764099121094
[2024-12-09 10:20:27,197][root][INFO] - Epoch 2
[2024-12-09 10:20:35,922][root][INFO] - train_loss: 43.55748963356018 | time: 8.726161003112793
[2024-12-09 10:20:35,924][root][INFO] - Epoch 3
[2024-12-09 10:20:44,687][root][INFO] - train_loss: 30.543150544166565 | time: 8.763671159744263
[2024-12-09 10:20:44,688][root][INFO] - Epoch 4
[2024-12-09 10:20:53,399][root][INFO] - train_loss: 36.11117231845856 | time: 8.711572885513306
[2024-12-09 10:20:53,401][root][INFO] - Epoch 5
[2024-12-09 10:21:02,206][root][INFO] - train_loss: 26.359211444854736 | time: 8.806751251220703
[2024-12-09 10:21:02,208][root][INFO] - Epoch 6
[2024-12-09 10:21:10,870][root][INFO] - train_loss: 311.39441454410553 | time: 8.662720680236816
[2024-12-09 10:21:10,872][root][INFO] - Epoch 7
[2024-12-09 10:21:19,565][root][INFO] - train_loss: 148.099911570549 | time: 8.695040225982666
[2024-12-09 10:21:19,567][root][INFO] - Epoch 8
[2024-12-09 10:21:28,306][root][INFO] - train_loss: 602.9464883804321 | time: 8.740160703659058
[2024-12-09 10:21:28,308][root][INFO] - Epoch 9
[2024-12-09 10:21:37,016][root][INFO] - train_loss: 1941.8028030395508 | time: 8.709407567977905
[2024-12-09 10:21:37,018][root][INFO] - Epoch 10
[2024-12-09 10:21:45,781][root][INFO] - train_loss: 1868.8514556884766 | time: 8.764141082763672
[2024-12-09 10:21:45,783][root][INFO] - Epoch 11
[2024-12-09 10:21:54,522][root][INFO] - train_loss: 2326.758010864258 | time: 8.740869760513306
[2024-12-09 10:21:54,524][root][INFO] - Epoch 12
[2024-12-09 10:22:03,276][root][INFO] - train_loss: 2177.338623046875 | time: 8.752907276153564
[2024-12-09 10:22:03,278][root][INFO] - Epoch 13
[2024-12-09 10:22:12,081][root][INFO] - train_loss: 2672.418716430664 | time: 8.804689645767212
[2024-12-09 10:22:12,083][root][INFO] - Epoch 14
[2024-12-09 10:22:16,635][root][INFO] - Terminated on NaN/INF triggered.
[2024-12-09 10:22:16,635][root][INFO] - Terminated on NaN/INF triggered.
[2024-12-09 10:22:16,635][root][INFO] - Terminated on NaN/INF triggered.
[2024-12-09 10:22:16,636][root][INFO] - Terminated on NaN/INF triggered.
[2024-12-09 10:22:16,642][root][INFO] - Total time: 127.19219851493835
[2024-12-09 10:22:16,642][root][INFO] - Total time: 127.19853925704956
[2024-12-09 10:22:16,642][root][INFO] - Total time: 127.19695234298706
[2024-12-09 10:22:16,642][root][INFO] - train_loss: 859.4282073974609 | time: 4.560784101486206
[2024-12-09 10:22:16,643][root][INFO] - Total time: 127.19257926940918
[2024-12-09 10:22:17,056][accelerate.accelerator][INFO] - Model weights saved in /cluster/scratch/ckeusch/dsl-as24-challenge-3/outputs/2024-12-09/10-19-48/model.pth/pytorch_model.bin
